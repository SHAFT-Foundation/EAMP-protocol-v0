# EAMP Architecture Overview

This overview of the Extended Accessibility Metadata Protocol (EAMP) discusses its scope, core concepts, and provides examples demonstrating each concept.

Because EAMP SDKs abstract away many concerns, most developers will find the [data layer protocol](#data-layer-protocol) section most useful. It discusses how EAMP servers can provide accessibility context to applications and assistive technologies.

For specific implementation details, refer to the documentation for your [language-specific SDK](../sdk/).

## Scope

The Extended Accessibility Metadata Protocol includes:

- [EAMP Specification](../../specification/): A specification outlining implementation requirements for clients and servers
- [EAMP SDKs](../sdk/): SDKs for different programming languages that implement EAMP
- **EAMP Development Tools**: Tools for developing EAMP servers and clients, including testing utilities
- [EAMP Reference Implementations](../../examples/): Reference implementations of EAMP servers and clients

EAMP focuses solely on the protocol for accessibility metadata exchange—it does not dictate how applications use the accessibility data or manage assistive technology integration.

## Core Concepts

### Participants

EAMP follows a client-server architecture where an EAMP host — an application like a web browser, mobile app, or AI agent — establishes connections to one or more EAMP servers. The EAMP host creates one EAMP client for each EAMP server, maintaining dedicated one-to-one connections.

The key participants are:

- **EAMP Host**: The application that coordinates and manages multiple EAMP clients (browsers, assistive tech, AI agents)
- **EAMP Client**: A component that maintains connection to an EAMP server and obtains accessibility metadata
- **EAMP Server**: A program that provides accessibility metadata to EAMP clients

**Example**: A screen reader acts as an EAMP host. When it connects to a website's EAMP server, it instantiates an EAMP client object to maintain that connection. If the user navigates to another EAMP-enabled site, a new client connection is established.

```
EAMP Host (Screen Reader/AI Agent)
    │
    ├── EAMP Client 1 ←→ EAMP Server 1 (Website A)  
    ├── EAMP Client 2 ←→ EAMP Server 2 (Website B)
    └── EAMP Client 3 ←→ EAMP Server 3 (Mobile App)
```

### Two-Layer Architecture  

EAMP consists of two complementary layers:

#### Layer 1 (Baseline) - WCAG Compliance
Traditional accessibility artifacts that work with existing assistive technologies:
- Short text alternatives (alt text, labels)  
- Captions and transcripts
- Accessible names, roles, and states
- Focus management and keyboard navigation

#### Layer 2 (Extended) - Rich Metadata
JSON-based structured metadata that provides enhanced context:
- Detailed descriptions and explanations
- Data tables and structured content
- Time-coded annotations for media
- Contextual information for UI elements
- Accessibility feature declarations

### Transport Mechanisms

EAMP supports multiple transport methods:

- **HTTP(S)**: RESTful API endpoints with JSON responses
- **WebSocket**: Real-time metadata updates  
- **IPFS/Arweave**: Decentralized content addressing
- **Local File**: Direct file system access for development

## Data Layer Protocol

### Discovery and Negotiation

EAMP clients discover servers through multiple mechanisms:

#### HTML Discovery
```html
<!-- Link element -->
<link rel="accessibilityMetadata" 
      href="https://api.example.com/eamp/page-123" 
      type="application/eamp+json" />

<!-- Data attribute -->
<img src="chart.png" 
     alt="Sales chart"
     data-eamp-metadata="https://api.example.com/eamp/chart-123" />

<!-- ARIA details -->
<img src="chart.png"
     alt="Sales chart" 
     aria-details="eamp-chart-details" />
```

#### HTTP Headers
```http
Link: <https://api.example.com/eamp/page-123>; rel="accessibilityMetadata"; type="application/eamp+json"
```

#### Content Negotiation
```http
GET /metadata/chart-123
Accept: application/eamp+json
User-Agent: NVDA/2023.1 (EAMP/1.0)
```

### Core Metadata Schema

```json
{
  "id": "chart-sales-2024",
  "type": "image",
  "eampVersion": "1.0.0",
  "shortAlt": "Quarterly sales chart for 2024",
  "extendedDescription": "Bar chart showing steady growth across Q1-Q4 2024, with Q4 showing the highest sales at $2.3M, representing 43% growth over Q1.",
  "dataPoints": [
    {"label": "Q1", "value": 1200000, "unit": "USD"},
    {"label": "Q2", "value": 1500000, "unit": "USD"},  
    {"label": "Q3", "value": 1900000, "unit": "USD"},
    {"label": "Q4", "value": 2300000, "unit": "USD"}
  ],
  "accessibilityFeatures": ["high-contrast", "screen-reader-optimized"],
  "tags": ["finance", "sales", "2024"],
  "sourceAttribution": "Generated by Shaft Analytics",
  "metadataURI": "https://api.example.com/eamp/chart-sales-2024"
}
```

### Content Types

EAMP supports various content types:

#### Images and Charts
```json
{
  "type": "image",
  "shortAlt": "Population growth chart",
  "extendedDescription": "Line chart showing...",
  "dataPoints": [...],
  "visualElements": [
    {"type": "axis", "label": "Years 2020-2024"},
    {"type": "legend", "position": "bottom-right"}
  ]
}
```

#### Video Content  
```json
{
  "type": "video",
  "shortAlt": "Product demonstration video",
  "transcript": "Speaker 1: Welcome to our product demo...",
  "scenes": [
    {"time": "0:00-0:30", "description": "Logo animation with company branding"},
    {"time": "0:31-1:15", "description": "Product interface walkthrough"}
  ],
  "accessibilityFeatures": ["captions", "audio-descriptions"]
}
```

#### UI Elements
```json
{
  "type": "ui-element", 
  "shortAlt": "Submit form",
  "extendedDescription": "Submits the contact form. All required fields must be completed. Form validation will show errors if any fields are missing.",
  "state": "enabled",
  "shortcuts": [{"key": "Enter", "description": "Submit form"}],
  "context": "Located at bottom of contact form"
}
```

## Real-Time Updates

EAMP supports notifications for dynamic content:

```json
{
  "method": "notifications/metadata_changed",
  "params": {
    "resourceId": "chart-sales-2024", 
    "changeType": "data_updated",
    "timestamp": "2024-09-04T10:30:00Z"
  }
}
```

## Internationalization

EAMP supports multiple languages through field suffixes:

```json
{
  "shortAlt_en": "Quarterly sales chart for 2024",
  "shortAlt_es": "Gráfico de ventas trimestrales de 2024",
  "extendedDescription_en": "Bar chart showing...",
  "extendedDescription_es": "Gráfico de barras que muestra..."
}
```

## Security and Privacy

- **Authentication**: Support for OAuth, API keys, and custom headers
- **Privacy**: Personal information redaction by default
- **Integrity**: Content addressing and optional cryptographic signatures
- **Caching**: Appropriate cache headers with ETags for performance

## Error Handling

Standard error format:

```json
{
  "error": {
    "code": "ValidationError",
    "message": "shortAlt exceeds 250 character limit", 
    "field": "shortAlt",
    "details": {
      "currentLength": 287,
      "maxLength": 250
    }
  }
}
```

## Integration Examples

### Browser Extension
```javascript
// Detect EAMP-enabled content
const metadataLink = document.querySelector('[data-eamp-metadata]');
if (metadataLink) {
  const response = await fetch(metadataLink.dataset.eampMetadata);
  const metadata = await response.json();
  announceToScreenReader(metadata.extendedDescription);
}
```

### AI Agent
```python
# AI agent consuming EAMP data
async def analyze_page_accessibility(url):
    metadata = await eamp_client.get_metadata(url)
    accessibility_score = calculate_score(metadata)
    return {
        'score': accessibility_score,
        'features': metadata.get('accessibilityFeatures', []),
        'recommendation': generate_recommendation(metadata)
    }
```

## Next Steps

- **Implement a Server**: Follow our [Server Quickstart](../quickstart/server.md)
- **Build a Client**: Check out [Client Quickstart](../quickstart/client.md)  
- **Explore SDKs**: View available [SDKs](../sdk/)
- **See Examples**: Browse [implementation examples](../examples/)